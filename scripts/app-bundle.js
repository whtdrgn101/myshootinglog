define("app",["exports","aurelia-framework","aurelia-router","common/shooting-log-store"],function(e,t,n,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.App=void 0;var s,a,l=r(o),u=(e.App=(s=(0,t.inject)(l.default),s(a=function(){function e(t){i(this,e),this.store=t;var n=null;try{n=JSON.parse(sessionStorage.store)}catch(e){}n&&(this.store=_.extend(this.store,n))}return e.prototype.configureRouter=function(e,t){e.title="My Shooting Log",e.addPipelineStep("authorize",u),e.map([{route:["","welcome"],name:"home",moduleId:"welcome",auth:!0,nav:!0,title:"Home",cs:this.store},{route:["scorecard"],name:"scorecard",moduleId:"round/scorecard",auth:!0,nav:!0,title:"Scorecard",cs:this.store},{route:["round"],name:"round",moduleId:"round/round",auth:!0,nav:!1,title:"Round",cs:this.store},{route:["bow_list"],name:"bow_list",moduleId:"bow/bow_list",auth:!0,nav:!0,title:"Bows",cs:this.store},{route:["bow"],name:"bow",moduleId:"bow/bow",auth:!0,nav:!1,title:"Bow Details",cs:this.store},{route:["profile"],name:"profile",moduleId:"user/profile",auth:!0,nav:!0,title:"Profile",cs:this.store},{route:["login"],name:"login",moduleId:"user/login",auth:!1,nav:!1,title:"Login",cs:this.store},{route:["register"],name:"register",moduleId:"user/register",auth:!1,nav:!1,title:"Register",cs:this.store}]),this.router=t},e}())||a),function(){function e(){i(this,e)}return e.prototype.run=function(e,t){if(e.getAllInstructions().some(function(e){return e.config.auth})){var o=JSON.parse(sessionStorage.getItem("auth-token"));if(null==o)return t.cancel(new n.Redirect("login"))}return t()},e}())}),define("environment",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={debug:!1,testing:!1,API_URL:"http://www.myshootinglog.com:8080"}}),define("main",["exports","./environment"],function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){e.use.standardConfiguration().feature("resources"),r.default.debug&&e.use.developmentLogging(),r.default.testing&&e.use.plugin("aurelia-testing"),e.start().then(function(){return e.setRoot()})}Object.defineProperty(e,"__esModule",{value:!0}),e.configure=o;var r=n(t);Promise.config({warnings:{wForgottenReturn:!1}})}),define("welcome",["exports","aurelia-framework","aurelia-router","common/shooting-log-store","aurelia-event-aggregator"],function(e,t,n,o,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Welcome=void 0;var a,l,u=i(o),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();e.Welcome=(a=(0,t.inject)(n.Router,u.default,r.EventAggregator),a(l=function(){function e(t,n,o){s(this,e),this.heading="Welcome to MyShootingLog!",this.last30Stats={},this.lifetimeStats={},this.router=t,this.store=n,this.eventAggregator=o}return e.prototype.activate=function(e,t){this.eventAggregator.publish("viewActivate");var n=this;this.store.getLast30Stats().then(function(e){n.last30Stats=e[0]}),this.store.getLifetimeStats().then(function(e){n.lifetimeStats=e[0]})},d(e,[{key:"latestRound",get:function(){}},{key:"mostUsedBow",get:function(){}}]),e}())||l)}),define("bow/bow",["exports","aurelia-framework","aurelia-router","common/shooting-log-store","aurelia-event-aggregator","../environment","aurelia-http-client"],function(e,t,n,o,r,i,s){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Bow=void 0;var u,d,c=a(o),h=a(i);e.Bow=(u=(0,t.inject)(n.Router,c.default,r.EventAggregator),u(d=function(){function e(t,n,o){var r=this;l(this,e),this.heading="Bow Details",this.bow={},this.bowTypes=["Compound","Crossbow","Longbow","Recurve","Self","Stick"],this.appRouter=t,this.store=n,this.eventAggregator=o,this.client=(new s.HttpClient).configure(function(e){e.withBaseUrl(h.default.API_URL),e.withHeader("x-authorization",r.store.authToken.token)})}return e.prototype.activate=function(e,t){var n=this;this.eventAggregator.publish("viewActivate"),this.getBowTypes();void 0!=e.id&&"-1"!==e.id&&this.client.get("/bow/"+e.id).then(function(e){n.bow=JSON.parse(e.response)}).catch(function(e){403===e.status?(alert("Session timeout, please log in again"),n.store.clearStore(),n.router.navigateToRoute("login")):n.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.save=function(){void 0===this.bow.id?this.addBow():this.updateBow()},e.prototype.updateBow=function(){var e=this,t=this;this.client.put("/bow/"+this.bow.id,JSON.stringify(this.bow)).then(function(n){t.bow=JSON.parse(n.response),e.appRouter.navigateBack()}).catch(function(t){403===t.status?(alert("Session timeout, please log in again"),e.store.clearStore(),e.router.navigateToRoute("login")):e.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.addBow=function(){var e=this,t=this;this.bow.member_id=this.store.authToken.userId,this.client.post("/bow",JSON.stringify(this.bow)).then(function(n){t.bow=JSON.parse(n.response),e.appRouter.navigateBack()}).catch(function(t){403===t.status?(alert("Session timeout, please log in again"),e.store.clearStore(),e.router.navigateToRoute("login")):e.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.getBowTypes=function(){var e=this,t=this;this.client.get("/bowtype",JSON.stringify(this.bow)).then(function(e){t.bowTypes=JSON.parse(e.response)}).catch(function(t){403===t.status?(alert("Session timeout, please log in again"),e.store.clearStore(),e.router.navigateToRoute("login")):e.error="An error occurred while retrieving list of bow types, please contact support or try again"})},e}())||d)}),define("bow/bow_list",["exports","aurelia-framework","aurelia-router","common/shooting-log-store","aurelia-http-client","../environment","aurelia-event-aggregator"],function(e,t,n,o,r,i,s){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.UpperValueConverter=e.BowList=void 0;var u,d,c=a(o),h=a(i);e.BowList=(u=(0,t.inject)(n.Router,c.default,s.EventAggregator),u(d=function(){function e(t,n,o){var i=this;l(this,e),this.heading="Your bows",this.appRouter=t,this.store=n,this.eventAggregator=o,this.client=(new r.HttpClient).configure(function(e){e.withBaseUrl(h.default.API_URL),e.withHeader("x-authorization",i.store.authToken.token)})}return e.prototype.newBow=function(){this.appRouter.navigateToRoute("bow",{id:-1})},e.prototype.editBow=function(e){this.appRouter.navigateToRoute("bow",{id:e.id})},e.prototype.deleteBow=function(e){var t=this,n=this;confirm("Are you sure you want to delete this bow?")&&this.client.delete("/bow/"+e.id).then(function(e){n.refreshBows()}).catch(function(e){403===e.status?(alert("Session timeout, please log in again"),t.store.clearStore(),t.router.navigateToRoute("login")):t.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.activate=function(){this.eventAggregator.publish("viewActivate"),this.refreshBows()},e.prototype.refreshBows=function(){var e=this,t=this;this.client.get("/user/"+this.store.authToken.userId+"/bows").then(function(e){t.bows=JSON.parse(e.response)}).catch(function(t){403===t.status?(alert("Session timeout, please log in again"),e.store.clearStore(),e.router.navigateToRoute("login")):e.error="An error occurred while retrieving the job list, please contact support or try again"})},e}())||d),e.UpperValueConverter=function(){function e(){l(this,e)}return e.prototype.toView=function(e){return e&&e.toUpperCase()},e}()}),define("user/login",["exports","aurelia-framework","aurelia-router","aurelia-event-aggregator","common/shooting-log-store"],function(e,t,n,o,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Login=void 0;var a,l,u=i(r);e.Login=(a=(0,t.inject)(n.Router,u.default,o.EventAggregator),a(l=function(){function e(t,n,o){s(this,e),this.errorMessage=null,this.user={email:"",password:""},this.appRouter=t,this.store=n,this.eventAggregator=o}return e.prototype.loginUser=function(){var e=this;e.errorMessage=null,this.store.authenticateUser(this.user.email,this.user.password).then(function(t){t&&(e.eventAggregator.publish("login.success",!0),e.appRouter.navigateToRoute("home"))}).catch(function(t){e.errorMessage=t})},e}())||l)}),define("user/profile",["exports","aurelia-framework","aurelia-router","common/shooting-log-store","aurelia-event-aggregator"],function(e,t,n,o,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.BlobToUrlValueConverter=e.Profile=void 0;var a,l,u=i(o);e.Profile=(a=(0,t.inject)(n.Router,u.default,r.EventAggregator),a(l=function(){function e(t,n,o){s(this,e),this.appRouter=t,this.store=n,this.dispatcher=o}return e.prototype.activate=function(){this.dispatcher.publish("viewActivate")},e.prototype.saveProfile=function(){this.dispatcher.publish("scorecard.changed")},e.prototype.embedFile=function(){var e=this;if(this.file){var t=new FileReader;t.onload=function(t){return function(t){e.store.user.image=t.target.result}}(this.file[0]),t.readAsDataURL(this.file[0])}},e}())||l),e.BlobToUrlValueConverter=function(){function e(){s(this,e)}return e.prototype.toView=function(e){if(e)return window.URL.createObjectURL(e[0])},e}()}),define("user/register",["exports","aurelia-framework","aurelia-router","common/shooting-log-store"],function(e,t,n,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Login=void 0;var s,a,l=r(o);e.Login=(s=(0,t.inject)(n.Router,l.default),s(a=function(){function e(t,n){i(this,e),this.errorMessage=null,this.user={email:"",password:"",confpassword:""},this.appRouter=t,this.dataLayer=n}return e.prototype.register=function(){if(this.user.password==this.user.confpassword){var e=this;e.errorMessage=null,this.dataLayer.register(this.user.email,this.user.password).then(function(t){t&&e.dataLayer.initUserScorecard(t).then(function(t){e.appRouter.navigateToRoute("login")},function(t){e.errorMessage="ERROR: "+t})}).catch(function(t){e.errorMessage="ERROR: "+t})}else this.message="ERROR: Passwords do not match"},e}())||a)}),define("resources/index",["exports"],function(e){"use strict";function t(e){}Object.defineProperty(e,"__esModule",{value:!0}),e.configure=t}),define("common/shooting-log-store",["exports","aurelia-framework","aurelia-fetch-client","aurelia-event-aggregator"],function(e,t,n,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,s,a=(i=(0,t.inject)(o.EventAggregator,n.HttpClient),i(s=function(){function e(t,n){var o=this;r(this,e),this.user=null,this.scorecard=null,this.errorMessage=null,this.round=null,this.bow=null,this.authToken=null,this.eventAggregator=t,n.configure(function(e){e.useStandardConfiguration().withDefaults({headers:{Accept:"application/json","X-Authorization":JSON.stringify(o.authToken)}}).withBaseUrl("http://www.myshootinglog.com:8080/")}),this.http=n,this.subscribe()}return e.prototype.subscribe=function(){var e=this;this.eventAggregator.subscribe("scorecard.changed",function(t){e.handleScorecardChanged()}),this.eventAggregator.subscribe("logout",function(t){e.handleLogout()}),this.eventAggregator.subscribe("viewActivate",function(t){e.handleViewActivate()}),this.eventAggregator.subscribe("bow.add",function(t){e.handleBowAdd(t)}),this.eventAggregator.subscribe("bow.update",function(t){e.handleBowUpdate(t)}),this.eventAggregator.subscribe("bow.delete",function(t){e.handleBowDelete(t)}),this.eventAggregator.subscribe("round.add",function(t){e.handleRoundAdd(t)}),this.eventAggregator.subscribe("round.delete",function(t){e.handleRoundDelete(t)}),this.eventAggregator.subscribe("round.update",function(t){e.handleRoundUpdate(t)}),this.eventAggregator.subscribe("bowStore.stale",function(t){e.handleBowStoreStale(t)}),this.eventAggregator.subscribe("roundStore.stale",function(t){e.handleRoundStoreStale(t)}),this.eventAggregator.subscribe("user.authenticated",function(t){e.handleUserAuthenticated(t)})},e.prototype.handleViewActivate=function(){this.user=this.getUserInSession(),this.authToken=JSON.parse(sessionStorage.getItem("auth-token"))},e.prototype.handleUserAuthenticated=function(e){this.authToken=e,sessionStorage.setItem("auth-token",JSON.stringify(e)),this.saveStore()},e.prototype.handleLogout=function(){this.user=null,this.authToken=null},e.prototype.handleScorecardChanged=function(){var e=this.getUserInSession(),t=this;return this.scorecard._id=void 0,this.scorecard.id=void 0,new Promise(function(n,o){t.http.fetch("scorecard/"+e.userId,{method:"put",body:JSON.stringify(t.scorecard)}).then(function(e){n(e)})})},e.prototype.handleRoundDelete=function(e){var t=this.getUserInSession(),n=this;this.http.fetch("scorecard/"+t.userId+"/rounds/"+e,{method:"delete"}).then(function(e){n.eventAggregator.publish("roundStore.stale")})},e.prototype.handleRoundAdd=function(e){var t=this.getUserInSession(),n=this;this.http.fetch("scorecard/"+t.userId+"/rounds",{method:"post",body:JSON.stringify(e)}).then(function(e){n.eventAggregator.publish("roundStore.stale")})},e.prototype.handleRoundUpdate=function(e){var t=this.getUserInSession(),n=this;this.http.fetch("scorecard/"+t.userId+"/rounds/"+e._id,{method:"put",body:JSON.stringify(e)}).then(function(e){n.eventAggregator.publish("roundStore.stale")})},e.prototype.handleRoundStoreStale=function(){var e=this.getUserInSession(),t=this;this.http.fetch("scorecard/"+e.userId+"/rounds").then(function(e){return e.json()}).then(function(e){t.scorecard.rounds=e})},e.prototype.handleBowAdd=function(e){var t=this.getUserInSession(),n=this;this.http.fetch("scorecard/"+t.userId+"/bows",{method:"post",body:JSON.stringify(e)}).then(function(e){n.eventAggregator.publish("bowStore.stale")})},e.prototype.handleBowUpdate=function(e){var t=this.getUserInSession(),n=this;this.http.fetch("scorecard/"+t.userId+"/bows/"+e._id,{method:"put",body:JSON.stringify(e)}).then(function(e){n.eventAggregator.publish("bowStore.stale")})},e.prototype.handleBowDelete=function(e){var t=this.getUserInSession(),n=this;this.http.fetch("scorecard/"+t.userId+"/bows/"+e,{method:"delete"}).then(function(e){n.eventAggregator.publish("bowStore.stale")})},e.prototype.handleBowStoreStale=function(){var e=this.getUserInSession(),t=this;this.http.fetch("scorecard/"+e.userId+"/bows").then(function(e){return e.json()}).then(function(e){t.scorecard.bows=e})},e.prototype.getScorecard=function(e){var t=this;return new Promise(function(n,o){null==t.scorecard||void 0==t.scorecard?t.http.fetch("scorecard/"+e).then(function(e){return e.json()}).then(function(e){n(e)}):n(t.scorecard)})},e.prototype.getBow=function(e){var t=this.getUserInSession(),n=this;return new Promise(function(o,r){n.http.fetch("scorecard/"+t.userId+"/bows/"+e).then(function(e){return e.json()}).then(function(e){o(e)})})},e.prototype.getRound=function(e){var t=this.getUserInSession(),n=this;return new Promise(function(o,r){n.http.fetch("scorecard/"+t.userId+"/rounds/"+e).then(function(e){return e.json()}).then(function(e){o(e)})})},e.prototype.getLast30Stats=function(){var e=this.getUserInSession(),t=this;return new Promise(function(n,o){t.http.fetch("stats/"+e.userId+"/last30").then(function(e){return e.json()}).then(function(e){n(e)})})},e.prototype.getLifetimeStats=function(){var e=this.getUserInSession(),t=this;return new Promise(function(n,o){t.http.fetch("stats/"+e.userId+"/lifetime").then(function(e){return e.json()}).then(function(e){n(e)})})},e.prototype.authenticateUser=function(e,t){var n=this;return new Promise(function(o,r){n.http.fetch("auth",{method:"post",body:JSON.stringify({email:e,password:t})}).then(function(e){return e.json()}).then(function(e){n.eventAggregator.publish("user.authenticated",e),o(e)}).catch(function(e){r(401===e.status?"Invalid username or password":"Unknown error occurred during login.  Please try again later")})})},e.prototype.getUserInSession=function(){var e=JSON.parse(sessionStorage.getItem("auth-token")),t={isAuthenticated:!1};return null!=e&&(t.userId=e.userId,t.isAuthenticated=!0),t},e.prototype.saveStore=function(){sessionStorage.store=JSON.stringify(this)},e.prototype.getUserDetails=function(e){var t={name:"",location:"",image:""};return this.scorecard.user.userId===e.userId&&(t.name=this.scorecard.user.details.name,t.location=this.scorecard.user.details.location,t.image=this.scorecard.user.details.image),t},e.prototype.register=function(e,t){var n=this;return new Promise(function(o,r){n.http.fetch("user",{method:"post",body:JSON.stringify({email:e,password:t})}).then(function(e){return e.json()}).then(function(e){o(e)}).catch(function(e){r(e)})})},e.prototype.initUserScorecard=function(e){var t={user:{accountId:e._id,email:e.email},rounds:[],bows:[]},n=this;return new Promise(function(e,o){n.http.fetch("scorecard",{method:"post",body:JSON.stringify(t)}).then(function(t){e(t)})})},e}())||s);e.default=a}),define("round/round",["exports","aurelia-framework","aurelia-router","common/shooting-log-store","aurelia-event-aggregator","underscore","../environment","aurelia-http-client"],function(e,t,n,o,r,i,s,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Round=void 0;var d,c,h=l(o),p=l(i),g=l(s);e.Round=(d=(0,t.inject)(n.Router,h.default,r.EventAggregator),d(c=function(){function e(t,n,o){var r=this;u(this,e),this.heading="Round",this.roundTypes=["FITA 18","FITA 25","FITA 30","FITA 50","FITA 70","FITA 90","Other"],this.newEndScore=30,this.newArrowCount=3,this.round={},this.appRouter=t,this.store=n,this.eventAggregator=o;var i=this;this.eventAggregator.subscribe("roundDate.send",function(e){i.handleDateChange(e)}),this.eventAggregator.subscribe("round.ends.change",function(e){i.handleRoundEndsChange(e)}),this.client=(new a.HttpClient).configure(function(e){e.withBaseUrl(g.default.API_URL),e.withHeader("x-authorization",r.store.authToken.token)})}return e.prototype.activate=function(e,t){var n=this;this.eventAggregator.publish("viewActivate");var o=this;this.client.get("/user/"+this.store.authToken.userId+"/bows").then(function(e){return o.bows=JSON.parse(e.response),o.client.get("/roundtype")}).then(function(t){o.roundTypes=JSON.parse(t.response),void 0!=e.id&&"-1"!==e.id?n.client.get("/round/"+e.id).then(function(e){o.round=JSON.parse(e.response)}):(o.round={round_date:new Date,total_score:30,ends:[{end_number:1,end_score:30,arrow_count:3}]},o.bows.length>0&&(o.round.bow_id=o.bows[0].id),o.roundTypes.length>0&&(o.round.round_type=o.roundTypes[0].id))}).catch(function(e){403===e.status?(alert("Session timeout, please log in again"),n.store.clearStore(),n.router.navigateToRoute("login")):n.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.addEnd=function(){this.round.ends.push({end_number:this.round.ends.length+1,arrow_count:this.newArrowCount,end_score:this.newEndScore}),this.eventAggregator.publish("round.ends.change",!0)},e.prototype.deleteEnd=function(e){var t=p.default.find(this.round.ends,function(t){return t._id==e._id});void 0!=t&&(this.round.ends=p.default.without(this.round.ends,t));var n=1;this.round.ends.forEach(function(e){e.end_number=n++}),this.eventAggregator.publish("round.ends.change",!0)},e.prototype.endChanged=function(){this.eventAggregator.publish("round.ends.change",!0)},e.prototype.save=function(){this.round.total_score=this.calculateRoundScore(this.round),void 0===this.round.id?this.addRound():this.updateRound()},e.prototype.addRound=function(){var e=this;this.round.member_id=this.store.authToken.userId,this.client.post("/round",JSON.stringify(this.round)).then(function(t){self.round=JSON.parse(t.response),e.appRouter.navigateBack()}).catch(function(t){403===t.status?(alert("Session timeout, please log in again"),e.store.clearStore(),e.router.navigateToRoute("login")):e.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.updateRound=function(){var e=this;this.client.put("/round/"+this.round.id,JSON.stringify(this.round)).then(function(t){self.round=JSON.parse(t.response),e.appRouter.navigateBack()}).catch(function(t){403===t.status?(alert("Session timeout, please log in again"),e.store.clearStore(),e.router.navigateToRoute("login")):e.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.handleRoundEndsChange=function(e,t){this.round.total_score=this.calculateRoundScore(this.round)},e.prototype.calculateRoundScore=function(e){var t=p.default.map(e.ends,function(e){return Number(e.end_score)});return t.reduce(function(e,t){return t?e+t:0},0)},e}())||c)}),define("round/scorecard",["exports","aurelia-framework","aurelia-router","common/shooting-log-store","aurelia-event-aggregator","../environment","aurelia-http-client"],function(e,t,n,o,r,i,s){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Welcome=void 0;var u,d,c=a(o),h=a(i);e.Welcome=(u=(0,t.inject)(n.Router,c.default,r.EventAggregator),u(d=function(){function e(t,n,o){var r=this;l(this,e),this.heading="Your scorecard",this.appRouter=t,this.store=n,this.eventAggregator=o,this.client=(new s.HttpClient).configure(function(e){e.withBaseUrl(h.default.API_URL),e.withHeader("x-authorization",r.store.authToken.token)})}return e.prototype.newRound=function(){this.appRouter.navigateToRoute("round",{id:-1})},e.prototype.editRound=function(e){this.appRouter.navigateToRoute("round",{id:e.id})},e.prototype.deleteRound=function(e){var t=this,n=this;confirm("Are you sure you want to delete this round?")&&this.client.delete("/round/"+e.id).then(function(e){n.refreshRounds()}).catch(function(e){403===e.status?(alert("Session timeout, please log in again"),t.store.clearStore(),t.router.navigateToRoute("login")):t.error="An error occurred while retrieving the job list, please contact support or try again"})},e.prototype.activate=function(){this.eventAggregator.publish("viewActivate"),this.refreshRounds()},e.prototype.refreshRounds=function(){var e=this,t=this;this.client.get("/user/"+this.store.authToken.userId+"/rounds").then(function(e){t.rounds=JSON.parse(e.response)}).catch(function(t){403===t.status?(alert("Session timeout, please log in again"),e.store.clearStore(),e.router.navigateToRoute("login")):e.error="An error occurred while retrieving the job list, please contact support or try again"})},e}())||d)}),define("resources/elements/nav-bar",["exports","aurelia-framework","common/shooting-log-store"],function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,o){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0})}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,n,o,r){var i={};return Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce(function(n,o){return o(e,t,n)||n},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}Object.defineProperty(e,"__esModule",{value:!0}),e.NavBar=void 0;var a,l,u,d,c=o(n),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();e.NavBar=(a=(0,t.inject)(c.default),a((u=function(){function e(t){i(this,e),r(this,"router",d,this),this.store=t}return e.prototype.logout=function(){sessionStorage.clear(),this.store.user=null,this.store.authToken=null,this.router.navigateToRoute("login")},h(e,[{key:"isAuthenticated",get:function(){var e=JSON.parse(sessionStorage.getItem("auth-token"));return null!==e}}]),e}(),d=s(u.prototype,"router",[t.bindable],{enumerable:!0,initializer:function(){return null}}),l=u))||l)}),define("resources/value-converters/dateFormatValueConverter",["exports","moment"],function(e,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.DateFormatValueConverter=void 0;var r=n(t);e.DateFormatValueConverter=function(){function e(){o(this,e)}return e.prototype.toView=function(e,t){return(0,r.default)(e).format(t)},e.prototype.fromView=function(e,t){return(0,r.default)(e,t)},e}()}),define("text!app.html",["module"],function(e){e.exports='<template>\n  <require from="resources/elements/nav-bar"></require>\n  <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">\n\n  <nav-bar router.bind="router"></nav-bar>\n\n  <div class="page-host">\n    <router-view></router-view>\n  </div>\n\n  <footer class="container-fluid">\n    <hr />\n    <div class="row">\n      <div class="col-sm-6 col-md-6 text-left"><span show.bind="store.user">Logged In As: ${store.user.email}</span></div>\n      <div class="col-sm-6 col-md-6 text-right"><span class="hidden-xs">MyShootingLog by <a href="mailto:timothy.dewees@gmail.com">Timothy DeWees</a></span></div>\n    </div>\n  </footer>\n\n</template>\n'}),define("text!welcome.html",["module"],function(e){e.exports='<template>\n  <section class="au-animate container-fluid">\n    <div class="page-header">\n      <h2>${heading}</h2>\n    </div>\n    <div class="container-fluid">\n      <div class="row">\n        <div class="box">\n          <h3>Dashboard:</h3>\n          <div class="col-md-3">\n            <div class="panel panel-default">\n              <div class="panel-heading">Last Round</div>\n              <div class="panel-body">\n                <dl>\n                  <dt>Score</dt>\n                  <dd></dd>\n                  <dt>Ends</dt>\n                  <dd></dd>\n                </dl>\n              </div>\n              <div class="panel-footer">details...</div>\n            </div>\n          </div>\n          <div class="col-md-3">\n            <div class="panel panel-default">\n              <div class="panel-heading">30 Day Stats (over ${last30Stats.count} rounds)</div>\n              <div class="panel-body">\n                <dl>\n                  <dt>Avg Score</dt>\n                  <dd>${last30Stats.averageRound}</dd>\n                  <dt>High Score</dt>\n                  <dd>${last30Stats.highRound}</dd>\n                  <dt>Low Score</dt>\n                  <dd>${last30Stats.lowRound}</dd>\n                </dl>\n              </div>\n              <div class="panel-footer">details...</div>\n            </div>\n          </div>\n          <div class="col-md-3">\n            <div class="panel panel-default">\n              <div class="panel-heading">Lifetime Stats (over ${lifetimeStats.count} rounds)</div>\n              <div class="panel-body">\n                <dl>\n                  <dt>Avg Score</dt>\n                  <dd>${lifetimeStats.averageRound}</dd>\n                  <dt>High Score</dt>\n                  <dd>${lifetimeStats.highRound}</dd>\n                  <dt>Low Score</dt>\n                  <dd>${lifetimeStats.lowRound}</dd>\n                </dl>\n              </div>\n              <div class="panel-footer">details...</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n'}),define("text!bow/bow.html",["module"],function(e){e.exports='<template>\n  <section class="au-animate container-fluid">\n    <h2>${heading}</h2>\n    <form class="form-horizontal" role="form" submit.delegate="save()">\n      <div class="form-group">\n        <label for="name">Name</label>\n        <input type="text" value.bind="bow.name" class="form-control" id="name" placeholder="" required>\n      </div>\n      <div class="form-group">\n        <label for="type">Type</label>\n        <select id="type" value.bind="bow.bow_type" class="form-control">\n          <option repeat.for="btype of bowTypes" value.bind="btype.id">${btype.name}</option>\n        </select>\n      </div>\n      <div class="form-group">\n        <label for="make">Make</label>\n        <input type="text" value.bind="bow.make" class="form-control" id="make" placeholder="" required>\n      </div>\n      <div class="form-group">\n        <label for="model">Model</label>\n        <input type="text" value.bind="bow.model" class="form-control" id="model" placeholder="" required>\n      </div>\n      <div class="form-group">\n        <label for="poundage">Poundage</label>\n        <input type="number" value.bind="bow.poundage" class="form-control" id="poundage" placeholder="" required>\n      </div>\n      <div class="form-group">\n        <label for="amoLength">AMO Length</label>\n        <input type="number" value.bind="bow.amo_length" class="form-control" id="amoLength" placeholder="">\n      </div>\n      <div class="form-group">\n        <label for="braceHeight">Brace Height</label>\n        <input type="number" value.bind="bow.brace_height" class="form-control" id="braceHeight" placeholder="">\n      </div>\n      <button type="submit" class="btn btn-default">Save</button>\n    </form>\n  </section>\n</template>\n'}),define("text!bow/bow_list.html",["module"],function(e){e.exports='<template>\n  <section class="au-animate container-fluid">\n    <div class="page-header">\n      <h2>${heading}&nbsp;\n        <button class="fa fa-plus" click.delegate="newBow()">\n          <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New Bow\n        </button>\n      </h2>\n    </div>\n    <div class="container-fluid">\n      <div class="row hidden-xs">\n        <div class="col-md-2 col-sm-2"></div>\n        <div class="col-md-3 col-sm-3"><strong>Name</strong></div>\n        <div class="col-md-1 col-sm-2"><strong>Type</strong></div>\n        <div class="col-md-1 col-sm-1"><strong>Make</strong></div>\n        <div class="col-md-1 col-sm-2"><strong>Model</strong></div>\n        <div class="col-md-1 col-sm-1"><strong>Poundage</strong></div>\n      </div>\n      <div class="row ${ $even ? \'even\' :\'\'}" repeat.for="bow of bows">\n        <div class="col-md-2 col-sm-2">\n          <button click.delegate="$parent.editBow(bow)"><span class="glyphicon glyphicon-pencil"></span></button>\n          <button click.delegate="$parent.deleteBow(bow)"><span class="glyphicon glyphicon-trash"></span></button>\n        </div>\n        <div class="col-md-3 col-sm-3"><strong class="visible-xs">Name</strong>${bow.name}</div>\n        <div class="col-md-1 col-sm-2"><strong class="visible-xs">Type</strong>${bow.bow_type_name}</div>\n        <div class="col-md-1 col-sm-1"><strong class="visible-xs">Make</strong>${bow.make}</div>\n        <div class="col-md-1 col-sm-2"><strong class="visible-xs">Model</strong>${bow.model}</div>\n        <div class="col-md-1 col-sm-1"><strong class="visible-xs">Poundage</strong>${bow.poundage}</div>\n      </div>\n    </div>\n  </section>\n</template>\n';
}),define("text!user/login.html",["module"],function(e){e.exports='<template>\n    <div class="container">\n        <div class="row">\n            <div class="box">\n                <div class="col-lg-12">\n                    <div class="jumbotron">\n                        <h1>My Shooting Log</h1>\n                        <p>Login to your account below or create an account and join the family <a route-href="route: register" class="btn btn-primary btn-md">register</a></p>\n                    </div>\n                    <form id="loginForm">\n                        <div class="col-md-3">\n                            <div class="panel panel-default">\n                                <div class="panel-heading">Please login</div>\n                                <div class="panel-body">\n                                    <fieldset class="form-group">\n                                        <label for="email">Email:</label>\n                                        <input type="text" class="form-control" id="email" value.bind="user.email" />\n                                    </fieldset>\n                                    <fieldset class="form-group">\n                                        <label for="password">Password:</label>\n                                        <input type="password" class="form-control" id="password" value.bind="user.password" />\n                                    </fieldset>\n                                    <p class="bg-danger" show.bind="errorMessage" >${errorMessage}</p>\n                                </div>\n                                <div class="panel-footer">\n                                    <button type="submit" class="btn btn-primary" click.delegate="loginUser()">Login</button>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="col-md-9">\n                            <img src="/content/img/hero.jpg" class="img-responsive img-rounded" />\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n'}),define("text!user/profile.html",["module"],function(e){e.exports='<template>\n  <section class="au-animate">\n    <div class="box">\n      <div class="row">\n        <div class="col-md-9">Your MyShootingLog Profile\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-md-3">\n          <img src.bind="store.user.image" />\n          <input type="file" accept="image/*" files.bind="file" change.delegate="embedFile()">\n\n        </div>\n        <div class="col-md-6">\n          <dl>\n            <dt>Login</dt>\n            <dd>${store.user.email}</dd>\n            <dt>Member Since</dt>\n            <dd>${store.user.member-since}</dd>\n            <dt>Name</dt>\n            <dd><input type="text" value.bind="store.user.name"></dd>\n            <dt>Location</dt>\n            <dd><input type="text" value.bind="store.user.location"></dd>\n            <dt>Most used bows:</dt>\n            <dd></dd>\n            <dt>Highest Lifetime Round Score:</dt>\n            <dd></dd>\n          </dl>\n          <button click.delegate="saveProfile()">Save</button>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n'}),define("text!user/register.html",["module"],function(e){e.exports='<template>\n    <div class="container">\n        <div class="row">\n            <div class="box">\n                <div class="col-lg-12">\n                  <div class="page-header">\n                    <h3>Welcome, please enter your email and password to create your account</h3>\n                  </div>\n                    <form id="registrationForm">\n                        <div class="col-md-3">\n                            <div class="panel panel-default">\n                                <div class="panel-heading">User Information</div>\n                                <div class="panel-body">\n                                    <fieldset class="form-group">\n                                        <label for="email">Email:</label>\n                                        <input type="text" class="form-control" id="email" value.bind="user.email" />\n                                    </fieldset>\n                                    <fieldset class="form-group">\n                                        <label for="password">Password:</label>\n                                        <input type="password" class="form-control" id="password" value.bind="user.password" />\n                                    </fieldset>\n                                    <fieldset class="form-group">\n                                        <label for="confpassword">Confirm password:</label>\n                                        <input type="password" class="form-control" id="confpassword" value.bind="user.confpassword" />\n                                    </fieldset>\n                                    <p class="bg-danger" show.bind="errorMessage" >${errorMessage}</p>\n                                </div>\n                                <div class="panel-footer">\n                                    <button type="submit" class="btn btn-primary" click.delegate="register()">Register</button>\n                                </div>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n'}),define("text!round/round.html",["module"],function(e){e.exports='<template>\n  <require from="../resources/value-converters/dateFormatValueConverter"></require>\n  <section class="au-animate container-fluid">\n    <form class="form-horizontal" role="form" submit.delegate="save()">\n      <fieldset>\n        <legend>${heading}</legend>\n        <div class="form-group">\n          <label for="round_date">Round Date</label>\n          <input type="date" value.bind="round.round_date | dateFormat: \'YYYY-MM-DD\'" class="form-control" id="round_date" placeholder="" required />\n        </div>\n        <div class="form-group">\n          <label for="type">Round Type</label>\n          <select id="type" class="form-control" value.bind="round.round_type" required>\n            <option repeat.for="type of roundTypes" model.bind="type.id">${type.name}</option>\n          </select>\n        </div>\n        <div class="form-group">\n          <label for="bow">Bow</label>\n          <select id="bow" class="form-control" value.bind="round.bow_id" required>\n            <option repeat.for="bow of bows" model.bind="bow.id">${bow.name}</option>\n          </select>\n        </div>\n        <div class="form-group">\n          <label for="notes">Notes</label>\n          <textarea id="notes" class="form-control" value.bind="round.notes" rows="7" cols="50"></textarea>\n        </div>\n        <div class="form-group">\n          <label for="score">Round Score</label>\n          <input type="number" value.bind="round.total_score" class="form-control" id="score" placeholder="" />\n        </div>\n        <div class="form-group">\n          <div class="row">\n            <div class="col-md-2 col-sm-2"><strong>Add New End:</strong></div>\n            <div class="col-md-8 col-sm-8">Arrows: <input type="number" value.bind="newArrowCount" placeholder="Arrow Count" /> Score: <input type="number" value.bind="newEndScore" placeholder="End Score" /><button click.delegate="addEnd()"><span class="glyphicon glyphicon-plus"></span></button></div>\n          </div>\n          <div class="row hidden-xs">\n            <div class="col-md-1 col-sm-1"></div>\n            <div class="col-md-1 col-sm-1"><strong>End#</strong></div>\n            <div class="col-md-1 col-sm-1"><strong>Arrows</strong></div>\n            <div class="col-md-2 col-sm-3"><strong>Score</strong></div>\n          </div>\n          <div class="row" repeat.for="end of round.ends">\n            <div class="col-md-1 col-sm-1">\n              <button click.delegate="$parent.deleteEnd(end)">\n                <span class="glyphicon glyphicon-trash"></span>\n              </button>\n            </div>\n            <div class="col-md-1 col-sm-1"><strong class="visible-xs">End#</strong>${end.end_number}</div>\n            <div class="col-md-1 col-sm-1"><strong class="visible-xs">Arrows</strong><input type="number" value.bind="end.arrow_count" change.delegate="$parent.endChanged()" class="form-control" id="end_ac_${end.end_number}" /></div>\n            <div class="col-md-2 col-sm-2"><strong class="visible-xs">Score</strong><input type="number" value.bind="end.end_score" change.delegate="$parent.endChanged()" class="form-control" id="end_${end.end_number}" /></div>\n          </div>\n        </div>\n        <button type="submit" class="btn btn-default">Save</button>\n      </fieldset>\n    </form>\n  </section>\n</template>\n'}),define("text!round/scorecard.html",["module"],function(e){e.exports='<template>\n  <require from="../resources/value-converters/dateFormatValueConverter"></require>\n  <section class="au-animate container-fluid">\n    <div class="page-header">\n      <h2>${heading}&nbsp;\n        <button click.delegate="newRound()">\n          <span class="glyphicon glyphicon-screenshot" aria-hidden="true"></span> New Round\n        </button>\n      </h2>\n    </div>\n    <p class="bg-danger" show.bind="errorMessage" >${errorMessage}</p>\n    <div class="container-fluid">\n      <div class="row hidden-xs">\n        <div class="col-md-2 col-sm-2"></div>\n        <div class="col-md-2 col-sm-2"><strong>Date</strong></div>\n        <div class="col-md-2 col-sm-2"><strong>Type</strong></div>\n        <div class="col-md-2 col-sm-2"><strong>Bow</strong></div>\n        <div class="col-md-1 col-sm-1"><strong>Score</strong></div>\n      </div>\n      <div class="row ${ $even ? \'even\' :\'\'}" repeat.for="round of rounds">\n        <div class="col-md-2 col-sm-2">\n          <button click.delegate="$parent.editRound(round)"><span class="glyphicon glyphicon-pencil"></span></button>\n          <button click.delegate="$parent.deleteRound(round)"><span class="glyphicon glyphicon-trash"></span></button>\n        </div>\n        <div class="col-md-2 col-sm-2"><strong class="visible-xs">Date</strong>${round.round_date | dateFormat: \'YYYY-MM-DD\'}</div>\n        <div class="col-md-2 col-sm-2"><strong class="visible-xs">Type</strong>${round.round_type_name}</div>\n        <div class="col-md-2 col-sm-2"><strong class="visible-xs">Bow</strong>${round.bow_name}</div>\n        <div class="col-md-1 col-sm-1"><strong class="visible-xs">Score</strong>${round.total_score}</div>\n      </div>\n    </div>\n  </section>\n</template>\n'}),define("text!resources/elements/nav-bar.html",["module"],function(e){e.exports='<template bindable="router">\n  <nav class="navbar navbar-default" role="navigation">\n    <div class="navbar-header">\n      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">\n        <span class="sr-only">Toggle Navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n      <a class="navbar-brand" href="#">\n        <span class="glyphicon glyphicon-home" aria-hidden="true"></span> ${router.title}\n      </a>\n    </div>\n\n    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">\n      <ul class="nav navbar-nav">\n        <li if.bind="isAuthenticated" repeat.for="row of router.navigation" class="${row.isActive ? \'active\' : \'\'}">\n          <a data-toggle="collapse" data-target="#bs-example-navbar-collapse-1.in" href.bind="row.href">${row.title}</a>\n        </li>\n      </ul>\n\n      <ul if.bind="!isAuthenticated" class="nav navbar-nav navbar-right">\n        <li><a href="/#/login">Login</a></li>\n        <li><a href="/#/register">Signup</a></li>\n      </ul>\n\n      <ul if.bind="isAuthenticated" class="nav navbar-nav navbar-right">\n        <li><a href="#" click.delegate="logout()">Logout</a></li>\n      </ul>\n\n      <ul class="nav navbar-nav navbar-right">\n        <li class="loader" if.bind="router.isNavigating">\n          <i class="fa fa-spinner fa-spin fa-2x"></i>\n        </li>\n      </ul>\n    </div>\n  </nav>\n</template>\n'});